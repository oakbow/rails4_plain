machine:
  timezone:
    Asia/Tokyo

test:
#  pre:
#    - bundle exec brakeman -4 -A -w 1 -z
  override:
    - |
        if [ -n "${BUNDLE_UPDATE}" ]; then
          exit 0
        fi
        echo ${GITHUB_ACCESS_TOKEN}
        bundle exec rspec
  post:
    - |
        gem update bundler --no-document
        bundle update simplecov
        bundle exec ruby lib/script/send_pull_request.rb
#        bash lib/script/create_pull_request_if_needed.sh
#        gem install circleci-bundle-update-pr
#        circleci-bundle-update-pr oakbow oakbow7@gmail.com

#deployment:
#  production:
#    branch: master
#    commands:
#      - |
#          bash lib/script/create_pull_request_if_needed.sh

#        if [ -z "${BUNDLE_UPDATE}" ] ; then
#          ./script/deploy-circleci.sh
#        else
#          gem install circleci-bundle-update-pr
#          circleci-bundle-update-pr CircleCI circleci@example.com
#        fi
#deployment:
#  auto-bundle-update:
#    branch: master
#    commands:
#      - >
##        if [ -n "${BUNDLE_UPDATE}" ] ; then
#          bash lib/script/create_pull_request_if_needed.sh
##        fi

general:
  artifacts:
    - "/tmp/coverage"
